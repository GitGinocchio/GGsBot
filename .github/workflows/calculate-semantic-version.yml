name: Calculate Semantic Version

on:
  pull_request:
    types: [opened, reopened, synchronize]  # Si attiva su creazione, riapertura, e commit su PR
    branches: [main]  # Si attiva solo sulle PR verso il branch main

jobs:
  version:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Python 3.12
        uses: actions/setup-python@v3
        with:
          python-version: "3.12"

      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          if [ -f requirements.txt ]; then pip install -r requirements.txt; fi
          
      - name: Calculate semantic version
        id: version
        run: |
          # Usa il tool python-semantic-release per calcolare la nuova versione semantica
          # Assicurati che questo tool sia installato (python-semantic-release Ã¨ usato qui come esempio)
          pip install python-semantic-release
          
          # Calcola la versione semantica
          VERSION=$(python -m semantic_release.version)
          echo "Calculated semantic version: $VERSION"
          echo "::set-output name=version::$VERSION"
          
      - name: Output the new version
        run: echo "The new calculated version is ${{ steps.version.outputs.version }}"
